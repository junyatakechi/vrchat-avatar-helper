# 概要
- iOSアプリ、ifacialmocapを使用します。
- https://www.ifacialmocap.com/for-developer/



# 注意点・トラブルシューティング

本プログラムを使用する前に、以下のネットワーク設定をご確認ください。正しく設定されていない場合、アプリ上で接続は成功していても**アバターが動かない（データが受信できない）**現象が発生します。

## ネットワーク環境の前提
* **同一Wi-Fi接続:**
  iPhoneとPCは必ず**同じWi-Fi（ローカルネットワーク）**に接続してください。
* **モバイル通信不可:**
  4G/5G回線では通信できません。必ずWi-Fiを使用してください。

## Windows ファイアウォールの設定（重要）
Unity Editor（またはビルド後のアプリ）で初めて実行する際、Windowsファイアウォールの警告が表示されます。
必ず以下の手順で通信を許可してください。許可されていない場合、PC側でデータがブロックされます。

## アプリ上では「接続成功」と表示されているのに動作しない場合
iPhone側で「Connection Successful」と表示されているにもかかわらず、Unity上でデータが受信できない（アバターが動かない）場合、**Windowsファイアウォールによって受信通信がブロックされている**可能性が非常に高いです。

PCからiPhoneへの「接続要求」は届いているため接続扱いになりますが、iPhoneからPCへの「データ送信」がファイアウォールで弾かれている状態です。
以下の手順で通信を許可してください。
1. **ファイアウォール設定を開く**
   - Windowsキーを押し、「**アプリの許可**」と入力します。
   - 検索結果の **[ファイアウォール経由のアプリケーションを許可する]** を開きます。

2. **Unity Editor の設定を変更する**
   - 右上の **[設定の変更]** ボタンをクリックします（管理者権限が必要です）。
   - リストから `Unity Editor`（ビルド後の場合はアプリ名）を探します。
   - **[プライベート] と [パブリック] の両方のチェックボックスをオン** にしてください。
     - *※ 自宅のWi-Fiであっても、Windowsが「パブリックネットワーク」と誤認識しているケースが多いため、両方許可することが重要です。*
3. **再起動**
   - 設定反映のため、Unity（またはアプリ）を再起動してください。

### **リストに「Unity Editor」がたくさんある場合**
Unityのバージョンアップを繰り返すと、許可リストに `Unity Editor` が大量に並ぶことがあります。どれが現在使用しているUnityか判断するのは難しいため、以下のどちらかの方法で対応してください。
* **方法A（確実）:**
  リストにある **すべての `Unity Editor` に対して**、同様に「プライベート」と「パブリック」の両方にチェックを入れてください。不要なものを許可しても害はありません。
* **方法B（リセット）:**
  リストにある `Unity Editor` をすべて選択して **[削除]** してください。その状態でUnityを再起動して再生ボタンを押すと、再び警告ポップアップが表示されるので、そこで改めて両方にチェックを入れて許可してください。


## ポートの競合
本プログラムは UDPポート `49983` を使用します。

* **他のアプリとの競合:**
  iFacialMocap公式のPC用ソフト（iFacialMocap to VMCなど）や、他のフェイストラッキングソフトが起動していると、ポートが占有されて受信できません。他のソフトは終了してから実行してください。